<html>
  <head>
  </head>
  <script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js" type="text/javascript"> </script>
  <script src="zepto.min.js" type="text/javascript"> </script>
  <script type="text/javascript">
    //Edit this \/
    const factory_addr="0xa51d28db4c0599d8fe4ae63e31fd0f18e268671e";
    const factory_abi=[ { "inputs": [ { "internalType": "string", "name": "name", "type": "string" }, { "internalType": "string", "name": "location", "type": "string" }, { "internalType": "string", "name": "date", "type": "string" }, { "internalType": "address", "name": "registry", "type": "address" } ], "name": "create_attendance", "outputs": [ { "internalType": "contract Attendance", "name": "", "type": "address" } ], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "string", "name": "attestation", "type": "string" }, { "internalType": "address", "name": "registry", "type": "address" } ], "name": "create_free_form", "outputs": [ { "internalType": "contract FreeForm", "name": "", "type": "address" } ], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "string", "name": "child_name", "type": "string" }, { "internalType": "address", "name": "parent", "type": "address" } ], "name": "create_registry", "outputs": [ { "internalType": "contract Registry", "name": "", "type": "address" } ], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [], "name": "init", "outputs": [ { "internalType": "contract Factory", "name": "", "type": "address" } ], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [], "name": "registries", "outputs": [ { "internalType": "address[]", "name": "", "type": "address[]" } ], "stateMutability": "view", "type": "function" } ];
    const zero_addr="0x0000000000000000000000000000000000000000";
    var provider, signer, factory_ro, factory_rw;
    function mm_connect() {
      provider = new ethers.providers.Web3Provider(window.ethereum);
      provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();
      factory_ro=new ethers.Contract(factory_addr, factory_abi, provider);
      factory_rw=new ethers.Contract(factory_addr, factory_abi, signer);
      $('#mm_connect').hide();
    }
    function new_registry(){
      name=prompt("Name");
      factory_rw.create_registry(name, zero_addr);
    }
    function show_registries(){
      factory_ro.registries();
    }
  </script>
  <body>
    <h1>Attestation Management</h1>
    <button id="mm_connect" onclick="mm_connect()">Connect to wallet</button>
    <h2>Registries</h2>
    <button id="new_registry" onclick="new_registry()">New Registry</button>
    <ul id="registries"></ul>
  </body>
</html>
